<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neon Notes - Sticky Notes App</title>
    <link rel="icon" type="image/x-icon" href="icons8-notes-64.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            margin-bottom: 30px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo h1 {
            font-size: 2.5rem;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45aaf2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .logo i {
            font-size: 2.8rem;
            color: #ff6b6b;
            text-shadow: 0 0 15px rgba(255, 107, 107, 0.6);
        }

        .controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        button {
            padding: 12px 20px;
            border: none;
            border-radius: 50px;
            background: linear-gradient(45deg, #45aaf2, #3867d6);
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(56, 103, 214, 0.4);
            touch-action: manipulation;
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(56, 103, 214, 0.6);
        }

        button.add-note {
            background: linear-gradient(45deg, #26de81, #20bf6b);
            box-shadow: 0 4px 15px rgba(32, 191, 107, 0.4);
        }

        button.add-note:hover {
            box-shadow: 0 6px 20px rgba(32, 191, 107, 0.6);
        }

        button.sync {
            background: linear-gradient(45deg, #fd9644, #fa8231);
            box-shadow: 0 4px 15px rgba(250, 130, 49, 0.4);
        }

        button.sync:hover {
            box-shadow: 0 6px 20px rgba(250, 130, 49, 0.6);
        }

        .quote-btn {
            background: linear-gradient(45deg, #a55eea, #8854d0);
            box-shadow: 0 4px 15px rgba(136, 84, 208, 0.4);
        }

        .quote-btn:hover {
            box-shadow: 0 6px 20px rgba(136, 84, 208, 0.6);
        }

        .canvas-btn {
            background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
        }

        .canvas-btn:hover {
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.6);
        }

        .layout-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            justify-content: center;
        }

        .layout-btn {
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .layout-btn.active {
            background: linear-gradient(45deg, #a55eea, #8854d0);
        }

        .notes-container {
            display: grid;
            gap: 25px;
            padding: 10px;
            transition: all 0.3s ease;
        }

        /* Enhanced grid layout for laptop screens */
        .grid-layout {
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        }

        /* Create a more dynamic grid with varied sizes */
        @media (min-width: 1024px) {
            .grid-layout {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                grid-auto-rows: minmax(250px, auto);
            }
            
            /* Create varied note sizes for a more interesting layout */
            .note:nth-child(5n+1) {
                grid-column: span 1;
                grid-row: span 1;
            }
            
            .note:nth-child(5n+2) {
                grid-column: span 1;
                grid-row: span 1;
            }
            
            .note:nth-child(5n+3) {
                grid-column: span 1;
                grid-row: span 1;
                min-height: 280px;
            }
            
            .note:nth-child(5n+4) {
                grid-column: span 1;
                grid-row: span 1;
            }
            
            .note:nth-child(5n+5) {
                grid-column: span 1;
                grid-row: span 1;
                min-height: 300px;
            }
        }

        .list-layout {
            grid-template-columns: 1fr;
        }

        .note {
            border-radius: 15px;
            padding: 20px;
            min-height: 250px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            cursor: grab;
            position: relative;
            overflow: hidden;
        }

        .note::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, #fc5c7d, #6a82fb);
        }

        .note:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
        }

        .note-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .note-title {
            font-size: 1.4rem;
            font-weight: bold;
            background: rgba(0, 0, 0, 0.2);
            padding: 5px 10px;
            border-radius: 8px;
            width: 80%;
            border: none;
            color: white;
        }

        .note-actions {
            display: flex;
            gap: 10px;
        }

        .note-action {
            background: rgba(255, 255, 255, 0.1);
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .note-action:hover {
            transform: scale(1.2);
            background: rgba(255, 255, 255, 0.2);
        }

        .note-content {
            flex-grow: 1;
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 10px;
            border: none;
            resize: none;
            color: white;
            margin-bottom: 15px;
            min-height: 150px;
        }

        .note-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: auto;
        }

        .note-date {
            font-size: 0.8rem;
            opacity: 0.7;
        }

        .note-color {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid rgba(255, 255, 255, 0.5);
        }

        .color-options {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 15px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 50px;
            backdrop-filter: blur(10px);
            z-index: 100;
            transition: all 0.3s ease;
        }

        .color-option {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 2px solid transparent;
        }

        .color-option:hover {
            transform: scale(1.2);
        }

        .search-container {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
        }

        .search-box {
            display: flex;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50px;
            overflow: hidden;
            width: 100%;
            max-width: 500px;
        }

        .search-box input {
            flex-grow: 1;
            padding: 15px 20px;
            border: none;
            background: transparent;
            color: white;
            font-size: 1rem;
        }

        .search-box button {
            border-radius: 0 50px 50px 0;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            background: linear-gradient(45deg, #26de81, #20bf6b);
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(32, 191, 107, 0.4);
            transform: translateX(100vw);
            transition: transform 0.5s ease;
            z-index: 1000;
        }

        .notification.show {
            transform: translateX(0);
        }

        /* Mobile color picker button */
        .mobile-color-toggle {
            display: none;
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(45deg, #a55eea, #8854d0);
            color: white;
            border: none;
            font-size: 1.5rem;
            box-shadow: 0 5px 20px rgba(136, 84, 208, 0.5);
            z-index: 101;
            cursor: pointer;
        }

        /* Modal for note preview */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border-radius: 20px;
            padding: 30px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            position: relative;
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }

        .modal-overlay.active .modal-content {
            transform: scale(1);
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.1);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .modal-close:hover {
            transform: rotate(90deg);
            background: rgba(255, 255, 255, 0.2);
        }

        .modal-title {
            font-size: 2.2rem;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .modal-body {
            font-size: 1.2rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }

        /* Quote section */
        .quote-section {
            position: fixed;
            bottom: 20px;
            left: 20px;
            max-width: 350px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            padding: 15px;
            backdrop-filter: blur(10px);
            z-index: 99;
            transform: translateY(100%);
            opacity: 0;
            transition: all 0.5s ease;
        }

        .quote-section.show {
            transform: translateY(0);
            opacity: 1;
        }

        .quote-text {
            font-style: italic;
            margin-bottom: 10px;
            font-size: 1.1rem;
            line-height: 1.4;
        }

        .quote-author {
            text-align: right;
            font-weight: bold;
            opacity: 0.8;
        }

        /* Canvas Modal Styles */
        .canvas-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .canvas-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .canvas-container {
            width: 95%;
            height: 95%;
            background: #1a1a2e;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 50px rgba(255, 107, 107, 0.3);
            overflow: hidden;
        }

        .canvas-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: rgba(0, 0, 0, 0.5);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .canvas-title {
            font-size: 1.5rem;
            font-weight: bold;
            background: transparent;
            border: none;
            color: white;
            width: 300px;
            padding: 5px 10px;
            border-radius: 5px;
        }

        .canvas-title:focus {
            outline: 2px solid #ff6b6b;
        }

        .canvas-controls {
            display: flex;
            gap: 10px;
        }

        .canvas-control-btn {
            padding: 8px 15px;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
            touch-action: manipulation;
        }

        .canvas-control-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .canvas-control-btn.save {
            background: linear-gradient(45deg, #26de81, #20bf6b);
        }

        .canvas-control-btn.clear {
            background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
        }

        .canvas-control-btn.close {
            background: linear-gradient(45deg, #a55eea, #8854d0);
        }

        .canvas-tools {
            display: flex;
            gap: 10px;
            padding: 10px 20px;
            background: rgba(0, 0, 0, 0.3);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            flex-wrap: wrap;
            align-items: center;
        }

        .tool-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
            touch-action: manipulation;
        }

        .tool-btn.active {
            background: #ff6b6b;
            transform: scale(1.1);
        }

        .tool-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .color-picker {
            display: flex;
            gap: 5px;
            align-items: center;
            flex-wrap: wrap;
        }

        .color-btn {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: all 0.2s ease;
            touch-action: manipulation;
        }

        .color-btn.active {
            transform: scale(1.2);
            border: 2px solid white;
        }

        .brush-size {
            display: flex;
            align-items: center;
            gap: 10px;
            color: white;
        }

        .brush-size input {
            width: 100px;
        }

        .canvas-area {
            flex-grow: 1;
            overflow: hidden;
            position: relative;
            touch-action: none;
        }

        #drawingCanvas {
            position: absolute;
            top: 0;
            left: 0;
            cursor: crosshair;
            touch-action: none;
        }

        /* Canvas List Modal */
        .canvas-list-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .canvas-list-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .canvas-list-container {
            width: 80%;
            max-width: 800px;
            height: 80%;
            background: #1a1a2e;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 50px rgba(255, 107, 107, 0.3);
            overflow: hidden;
        }

        .canvas-list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0.5);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .canvas-list-title {
            font-size: 1.8rem;
            font-weight: bold;
        }

        .canvas-list-close {
            background: rgba(255, 255, 255, 0.1);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .canvas-list-close:hover {
            transform: rotate(90deg);
            background: rgba(255, 255, 255, 0.2);
        }

        .canvas-list-body {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .canvas-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }

        .canvas-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .canvas-item:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        .canvas-thumbnail {
            width: 100%;
            height: 120px;
            background: #2d2d4d;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .canvas-thumbnail canvas {
            max-width: 100%;
            max-height: 100%;
        }

        .canvas-item-name {
            font-weight: bold;
            text-align: center;
        }

        .canvas-item-date {
            font-size: 0.8rem;
            opacity: 0.7;
        }

        .no-canvases {
            grid-column: 1 / -1;
            text-align: center;
            padding: 40px;
            opacity: 0.7;
        }

        .canvas-list-footer {
            padding: 20px;
            display: flex;
            justify-content: center;
            background: rgba(0, 0, 0, 0.3);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Mobile-specific styles */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            header {
                flex-direction: column;
                gap: 20px;
                padding: 10px 0;
            }
            
            .logo h1 {
                font-size: 2rem;
            }
            
            .controls {
                width: 100%;
                justify-content: center;
                flex-wrap: wrap;
                gap: 10px;
            }
            
            button {
                padding: 10px 15px;
                font-size: 0.9rem;
            }
            
            .notes-container {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .note {
                padding: 15px;
                min-height: 200px;
            }
            
            .color-options {
                flex-wrap: wrap;
                justify-content: center;
                width: 90%;
                bottom: 90px;
                border-radius: 20px;
                padding: 10px;
                transform: translateX(-50%) scale(0);
                opacity: 0;
                transition: all 0.3s ease;
                pointer-events: none;
            }
            
            .color-options.expanded {
                transform: translateX(-50%) scale(1);
                opacity: 1;
                pointer-events: auto;
            }
            
            .mobile-color-toggle {
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .quote-section {
                left: 10px;
                right: 10px;
                max-width: none;
                bottom: 100px;
            }
            
            /* Mobile canvas styles */
            .canvas-container {
                width: 100%;
                height: 100%;
                border-radius: 0;
            }
            
            .canvas-header {
                flex-direction: column;
                gap: 15px;
                padding: 10px 15px;
            }
            
            .canvas-title {
                width: 100%;
                font-size: 1.2rem;
            }
            
            .canvas-controls {
                width: 100%;
                justify-content: space-between;
            }
            
            .canvas-control-btn {
                padding: 10px 15px;
                font-size: 0.9rem;
                flex: 1;
                margin: 0 5px;
                text-align: center;
            }
            
            .canvas-tools {
                padding: 10px 15px;
                justify-content: center;
            }
            
            .tool-btn {
                width: 45px;
                height: 45px;
                font-size: 1.1rem;
            }
            
            .color-picker {
                justify-content: center;
            }
            
            .brush-size {
                flex: 1;
                justify-content: center;
                min-width: 150px;
            }
            
            .brush-size input {
                width: 80px;
            }
            
            /* Mobile canvas list styles */
            .canvas-list-container {
                width: 95%;
                height: 95%;
                border-radius: 10px;
            }
            
            .canvas-list-header {
                padding: 15px;
            }
            
            .canvas-list-title {
                font-size: 1.5rem;
            }
            
            .canvas-list {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
                gap: 15px;
            }
            
            .canvas-item {
                padding: 10px;
            }
            
            .canvas-thumbnail {
                height: 100px;
            }
            
            .canvas-list-footer {
                padding: 15px;
            }
            
            .modal-content {
                padding: 20px;
            }
            
            .modal-title {
                font-size: 1.8rem;
            }
        }

        @media (max-width: 480px) {
            .logo h1 {
                font-size: 1.5rem;
            }
            
            .logo i {
                font-size: 2rem;
            }
            
            button {
                padding: 8px 12px;
                font-size: 0.8rem;
            }
            
            .canvas-control-btn {
                padding: 8px 10px;
                font-size: 0.8rem;
            }
            
            .tool-btn {
                width: 40px;
                height: 40px;
                font-size: 1rem;
            }
            
            .canvas-list {
                grid-template-columns: 1fr;
            }
            
            .brush-size {
                min-width: 120px;
            }
        }

        /* Animation for new notes */
        @keyframes noteAppear {
            from {
                opacity: 0;
                transform: scale(0.5) rotate(-5deg);
            }
            to {
                opacity: 1;
                transform: scale(1) rotate(0);
            }
        }

        .new-note {
            animation: noteAppear 0.5s ease;
        }

        /* Pulse animation for sync */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .pulse {
            animation: pulse 0.5s ease;
        }

        /* Drag and drop styles */
        .dragging {
            opacity: 0.7;
            transform: rotate(5deg);
        }

        .drag-over {
            border: 2px dashed rgba(255, 255, 255, 0.5);
        }

        /* Animation for quotes */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .quote-animation {
            animation: fadeInUp 0.5s ease forwards;
        }

        /* Different note colors */
        .note-color-1 { background: linear-gradient(135deg, #fc5c7d, #6a82fb); }
        .note-color-2 { background: linear-gradient(135deg, #c2e59c, #64b3f4); }
        .note-color-3 { background: linear-gradient(135deg, #ff758c, #ff7eb3); }
        .note-color-4 { background: linear-gradient(135deg, #7f00ff, #e100ff); }
        .note-color-5 { background: linear-gradient(135deg, #ff9a9e, #fad0c4); }
        .note-color-6 { background: linear-gradient(135deg, #a1c4fd, #c2e9fb); }
        .note-color-7 { background: linear-gradient(135deg, #f6d365, #fda085); }
        .note-color-8 { background: linear-gradient(135deg, #fbc2eb, #a6c1ee); }
        .note-color-9 { background: linear-gradient(135deg, #84fab0, #8fd3f4); }
        .note-color-10 { background: linear-gradient(135deg, #d4fc79, #96e6a1); }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-sticky-note"></i>
                <h1>Neon Notes</h1>
            </div>
            <div class="controls">
                <button class="add-note" id="addNote">
                    <i class="fas fa-plus"></i> Add Note
                </button>
                <button class="canvas-btn" id="canvasBtn">
                    <i class="fas fa-paint-brush"></i> Canvas
                </button>
                <button class="sync" id="syncNotes">
                    <i class="fas fa-sync-alt"></i> Sync
                </button>
                <button class="quote-btn" id="quoteBtn">
                    <i class="fas fa-quote-right"></i> Motivate Me
                </button>
            </div>
        </header>

        <div class="search-container">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Search notes...">
                <button id="searchBtn"><i class="fas fa-search"></i></button>
            </div>
        </div>

        <div class="layout-controls">
            <button class="layout-btn active" data-layout="grid">
                <i class="fas fa-th-large"></i> Grid
            </button>
            <button class="layout-btn" data-layout="list">
                <i class="fas fa-list"></i> List
            </button>
        </div>

        <div class="notes-container grid-layout" id="notesContainer">
            <!-- Notes will be added here dynamically -->
        </div>

        <div class="color-options" id="colorOptions">
            <!-- Color options will be added here dynamically -->
        </div>
        
        <button class="mobile-color-toggle" id="mobileColorToggle">
            <i class="fas fa-palette"></i>
        </button>

        <div class="notification" id="notification">
            <span id="notificationText"></span>
        </div>

        <!-- Modal for note preview -->
        <div class="modal-overlay" id="previewModal">
            <div class="modal-content">
                <div class="modal-close" id="modalClose">
                    <i class="fas fa-times"></i>
                </div>
                <h2 class="modal-title" id="modalTitle"></h2>
                <div class="modal-body" id="modalBody"></div>
            </div>
        </div>

        <!-- Quote section -->
        <div class="quote-section" id="quoteSection">
            <div class="quote-text" id="quoteText"></div>
            <div class="quote-author" id="quoteAuthor"></div>
        </div>

        <!-- Canvas Modal -->
        <div class="canvas-modal" id="canvasModal">
            <div class="canvas-container">
                <div class="canvas-header">
                    <input type="text" class="canvas-title" id="canvasTitle" placeholder="Untitled Canvas" value="Untitled Canvas">
                    <div class="canvas-controls">
                        <button class="canvas-control-btn save" id="saveCanvas">
                            <i class="fas fa-save"></i> Save
                        </button>
                        <button class="canvas-control-btn clear" id="clearCanvas">
                            <i class="fas fa-trash"></i> Clear
                        </button>
                        <button class="canvas-control-btn close" id="closeCanvas">
                            <i class="fas fa-times"></i> Close
                        </button>
                    </div>
                </div>
                <div class="canvas-tools">
                    <div class="tool-btn active" data-tool="pen" title="Pen">
                        <i class="fas fa-pen"></i>
                    </div>
                    <div class="tool-btn" data-tool="eraser" title="Eraser">
                        <i class="fas fa-eraser"></i>
                    </div>
                    <div class="color-picker">
                        <div class="color-btn active" style="background: #ff6b6b;" data-color="#ff6b6b"></div>
                        <div class="color-btn" style="background: #4ecdc4;" data-color="#4ecdc4"></div>
                        <div class="color-btn" style="background: #45aaf2;" data-color="#45aaf2"></div>
                        <div class="color-btn" style="background: #a55eea;" data-color="#a55eea"></div>
                        <div class="color-btn" style="background: #26de81;" data-color="#26de81"></div>
                        <div class="color-btn" style="background: #f7b731;" data-color="#f7b731"></div>
                        <div class="color-btn" style="background: #ffffff;" data-color="#ffffff"></div>
                        <div class="color-btn" style="background: #000000;" data-color="#000000"></div>
                    </div>
                    <div class="brush-size">
                        <span>Size:</span>
                        <input type="range" id="brushSize" min="1" max="50" value="5">
                        <span id="brushSizeValue">5</span>
                    </div>
                </div>
                <div class="canvas-area">
                    <canvas id="drawingCanvas"></canvas>
                </div>
            </div>
        </div>

        <!-- Canvas List Modal -->
        <div class="canvas-list-modal" id="canvasListModal">
            <div class="canvas-list-container">
                <div class="canvas-list-header">
                    <div class="canvas-list-title">My Canvases</div>
                    <div class="canvas-list-close" id="closeCanvasList">
                        <i class="fas fa-times"></i>
                    </div>
                </div>
                <div class="canvas-list-body">
                    <div class="canvas-list" id="canvasList">
                        <!-- Canvas items will be added here dynamically -->
                    </div>
                </div>
                <div class="canvas-list-footer">
                    <button class="canvas-control-btn" id="createNewCanvas">
                        <i class="fas fa-plus"></i> Create New Canvas
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCKlWp29jWfMzDbPNG0-NhjUZFR7Ac0vpo",
            authDomain: "world-airport-transfer.firebaseapp.com",
            projectId: "world-airport-transfer",
            storageBucket: "world-airport-transfer.firebasestorage.app",
            messagingSenderId: "590389404021",
            appId: "1:590389404021:web:1cf4af9b10731c266df33c",
            measurementId: "G-34X5SFC0KD",
            databaseURL: "https://world-airport-transfer-default-rtdb.asia-southeast1.firebasedatabase.app/"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // DOM elements
        const notesContainer = document.getElementById('notesContainer');
        const addNoteBtn = document.getElementById('addNote');
        const canvasBtn = document.getElementById('canvasBtn');
        const syncNotesBtn = document.getElementById('syncNotes');
        const quoteBtn = document.getElementById('quoteBtn');
        const layoutBtns = document.querySelectorAll('.layout-btn');
        const searchInput = document.getElementById('searchInput');
        const searchBtn = document.getElementById('searchBtn');
        const colorOptions = document.getElementById('colorOptions');
        const mobileColorToggle = document.getElementById('mobileColorToggle');
        const notification = document.getElementById('notification');
        const notificationText = document.getElementById('notificationText');
        const previewModal = document.getElementById('previewModal');
        const modalClose = document.getElementById('modalClose');
        const modalTitle = document.getElementById('modalTitle');
        const modalBody = document.getElementById('modalBody');
        const quoteSection = document.getElementById('quoteSection');
        const quoteText = document.getElementById('quoteText');
        const quoteAuthor = document.getElementById('quoteAuthor');
        
        // Canvas elements
        const canvasModal = document.getElementById('canvasModal');
        const canvasListModal = document.getElementById('canvasListModal');
        const drawingCanvas = document.getElementById('drawingCanvas');
        const canvasTitle = document.getElementById('canvasTitle');
        const saveCanvasBtn = document.getElementById('saveCanvas');
        const clearCanvasBtn = document.getElementById('clearCanvas');
        const closeCanvasBtn = document.getElementById('closeCanvas');
        const closeCanvasListBtn = document.getElementById('closeCanvasList');
        const createNewCanvasBtn = document.getElementById('createNewCanvas');
        const canvasList = document.getElementById('canvasList');
        const toolBtns = document.querySelectorAll('.tool-btn');
        const colorBtns = document.querySelectorAll('.color-btn');
        const brushSize = document.getElementById('brushSize');
        const brushSizeValue = document.getElementById('brushSizeValue');

        // Note colors
        const noteColors = [
            'note-color-1', 'note-color-2', 'note-color-3', 
            'note-color-4', 'note-color-5', 'note-color-6',
            'note-color-7', 'note-color-8', 'note-color-9',
            'note-color-10'
        ];

        // Motivational quotes
        const motivationalQuotes = [
            { text: "The only way to do great work is to love what you do.", author: "Steve Jobs" },
            { text: "Believe you can and you're halfway there.", author: "Theodore Roosevelt" },
            { text: "It always seems impossible until it's done.", author: "Nelson Mandela" },
            { text: "Don't watch the clock; do what it does. Keep going.", author: "Sam Levenson" },
            { text: "Success is not final, failure is not fatal: it is the courage to continue that counts.", author: "Winston Churchill" },
            { text: "The future belongs to those who believe in the beauty of their dreams.", author: "Eleanor Roosevelt" },
            { text: "The only limit to our realization of tomorrow will be our doubts of today.", author: "Franklin D. Roosevelt" },
            { text: "You are never too old to set another goal or to dream a new dream.", author: "C.S. Lewis" },
            { text: "Your time is limited, so don't waste it living someone else's life.", author: "Steve Jobs" },
            { text: "The way to get started is to quit talking and begin doing.", author: "Walt Disney" }
        ];

        // Current state
        let currentLayout = 'grid';
        let notes = [];
        let canvases = [];
        let draggedNote = null;
        let selectedNoteId = null;
        
        // Canvas state
        let currentCanvas = null;
        let isDrawing = false;
        let lastX = 0;
        let lastY = 0;
        let currentTool = 'pen';
        let currentColor = '#ff6b6b';
        let currentBrushSize = 5;
        let canvasContext = null;

        // Initialize the app
        function init() {
            createColorOptions();
            loadNotesFromFirebase();
            loadCanvasesFromFirebase();
            setupEventListeners();
            setupCanvas();
            
            // Show welcome message after a short delay
            setTimeout(() => {
                showNotification('Welcome to Neon Notes! Your notes are automatically saved.');
            }, 1000);
        }

        // Set up event listeners
        function setupEventListeners() {
            addNoteBtn.addEventListener('click', createNewNote);
            canvasBtn.addEventListener('click', showCanvasList);
            syncNotesBtn.addEventListener('click', syncNotesWithFirebase);
            quoteBtn.addEventListener('click', showRandomQuote);
            
            layoutBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const layout = btn.getAttribute('data-layout');
                    changeLayout(layout);
                    
                    layoutBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                });
            });
            
            searchBtn.addEventListener('click', searchNotes);
            searchInput.addEventListener('input', searchNotes);
            
            // Mobile color picker toggle
            mobileColorToggle.addEventListener('click', function(e) {
                e.stopPropagation();
                colorOptions.classList.toggle('expanded');
            });
            
            // Close color picker when clicking outside
            document.addEventListener('click', (e) => {
                if (!colorOptions.contains(e.target) && e.target !== mobileColorToggle) {
                    colorOptions.classList.remove('expanded');
                }
            });
            
            // Prevent color options from closing when clicking inside
            colorOptions.addEventListener('click', (e) => {
                e.stopPropagation();
            });
            
            // Modal close button
            modalClose.addEventListener('click', () => {
                previewModal.classList.remove('active');
            });
            
            // Close modal when clicking outside
            previewModal.addEventListener('click', (e) => {
                if (e.target === previewModal) {
                    previewModal.classList.remove('active');
                }
            });
            
            // Canvas event listeners
            saveCanvasBtn.addEventListener('click', saveCanvas);
            clearCanvasBtn.addEventListener('click', clearCanvas);
            closeCanvasBtn.addEventListener('click', closeCanvas);
            closeCanvasListBtn.addEventListener('click', closeCanvasList);
            createNewCanvasBtn.addEventListener('click', createNewCanvas);
            
            // Canvas tool buttons
            toolBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    toolBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentTool = btn.getAttribute('data-tool');
                });
            });
            
            // Color buttons
            colorBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    colorBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentColor = btn.getAttribute('data-color');
                });
            });
            
            // Brush size
            brushSize.addEventListener('input', () => {
                currentBrushSize = brushSize.value;
                brushSizeValue.textContent = currentBrushSize;
            });
            
            // Drag and drop events
            notesContainer.addEventListener('dragstart', handleDragStart);
            notesContainer.addEventListener('dragend', handleDragEnd);
            notesContainer.addEventListener('dragover', handleDragOver);
            notesContainer.addEventListener('drop', handleDrop);
        }

        // Setup canvas for drawing
        function setupCanvas() {
            canvasContext = drawingCanvas.getContext('2d');
            
            // Set canvas size to match its container
            function resizeCanvas() {
                const container = drawingCanvas.parentElement;
                drawingCanvas.width = container.clientWidth;
                drawingCanvas.height = container.clientHeight;
                
                // Redraw current canvas if it exists
                if (currentCanvas && currentCanvas.data) {
                    const img = new Image();
                    img.onload = function() {
                        canvasContext.drawImage(img, 0, 0);
                    };
                    img.src = currentCanvas.data;
                }
            }
            
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);
            
            // Drawing event listeners
            drawingCanvas.addEventListener('mousedown', startDrawing);
            drawingCanvas.addEventListener('mousemove', draw);
            drawingCanvas.addEventListener('mouseup', stopDrawing);
            drawingCanvas.addEventListener('mouseout', stopDrawing);
            
            // Touch events for mobile
            drawingCanvas.addEventListener('touchstart', handleTouchStart, { passive: false });
            drawingCanvas.addEventListener('touchmove', handleTouchMove, { passive: false });
            drawingCanvas.addEventListener('touchend', stopDrawing);
        }

        // Canvas drawing functions
        function startDrawing(e) {
            isDrawing = true;
            const pos = getMousePos(e);
            [lastX, lastY] = [pos.x, pos.y];
            
            // Prevent default to avoid scrolling on touch devices
            if (e.type === 'touchstart') {
                e.preventDefault();
            }
        }

        function draw(e) {
            if (!isDrawing) return;
            
            const pos = getMousePos(e);
            canvasContext.lineJoin = 'round';
            canvasContext.lineCap = 'round';
            
            if (currentTool === 'pen') {
                canvasContext.strokeStyle = currentColor;
                canvasContext.lineWidth = currentBrushSize;
            } else if (currentTool === 'eraser') {
                canvasContext.strokeStyle = '#1a1a2e';
                canvasContext.lineWidth = currentBrushSize * 2;
            }
            
            canvasContext.beginPath();
            canvasContext.moveTo(lastX, lastY);
            canvasContext.lineTo(pos.x, pos.y);
            canvasContext.stroke();
            
            [lastX, lastY] = [pos.x, pos.y];
            
            // Prevent default to avoid scrolling on touch devices
            if (e.type === 'touchmove') {
                e.preventDefault();
            }
        }

        function stopDrawing() {
            isDrawing = false;
        }

        function getMousePos(e) {
            const rect = drawingCanvas.getBoundingClientRect();
            let x, y;
            
            if (e.type.includes('touch')) {
                x = e.touches[0].clientX - rect.left;
                y = e.touches[0].clientY - rect.top;
            } else {
                x = e.clientX - rect.left;
                y = e.clientY - rect.top;
            }
            
            return { x, y };
        }

        function handleTouchStart(e) {
            startDrawing(e.touches[0]);
        }

        function handleTouchMove(e) {
            draw(e.touches[0]);
        }

        function clearCanvas() {
            if (confirm('Are you sure you want to clear the canvas?')) {
                canvasContext.fillStyle = '#1a1a2e';
                canvasContext.fillRect(0, 0, drawingCanvas.width, drawingCanvas.height);
            }
        }

        function saveCanvas() {
            if (!currentCanvas) {
                currentCanvas = {
                    id: Date.now().toString(),
                    name: canvasTitle.value,
                    date: new Date().toLocaleString(),
                    data: drawingCanvas.toDataURL()
                };
                canvases.push(currentCanvas);
            } else {
                currentCanvas.name = canvasTitle.value;
                currentCanvas.date = new Date().toLocaleString();
                currentCanvas.data = drawingCanvas.toDataURL();
            }
            
            saveCanvasesToFirebase();
            showNotification('Canvas saved successfully!');
            closeCanvas();
        }

        function createNewCanvas() {
            currentCanvas = null;
            canvasTitle.value = 'Untitled Canvas';
            canvasContext.fillStyle = '#1a1a2e';
            canvasContext.fillRect(0, 0, drawingCanvas.width, drawingCanvas.height);
            canvasModal.classList.add('active');
            canvasListModal.classList.remove('active');
        }

        function openCanvas(canvasId) {
            const canvas = canvases.find(c => c.id === canvasId);
            if (canvas) {
                currentCanvas = canvas;
                canvasTitle.value = canvas.name;
                
                const img = new Image();
                img.onload = function() {
                    canvasContext.drawImage(img, 0, 0);
                };
                img.src = canvas.data;
                
                canvasModal.classList.add('active');
                canvasListModal.classList.remove('active');
            }
        }

        function closeCanvas() {
            canvasModal.classList.remove('active');
        }

        function showCanvasList() {
            renderCanvasList();
            canvasListModal.classList.add('active');
        }

        function closeCanvasList() {
            canvasListModal.classList.remove('active');
        }

        function renderCanvasList() {
            canvasList.innerHTML = '';
            
            if (canvases.length === 0) {
                canvasList.innerHTML = '<div class="no-canvases">No canvases yet. Create your first one!</div>';
                return;
            }
            
            canvases.forEach(canvas => {
                const canvasItem = document.createElement('div');
                canvasItem.className = 'canvas-item';
                canvasItem.setAttribute('data-id', canvas.id);
                
                canvasItem.innerHTML = `
                    <div class="canvas-thumbnail">
                        <canvas width="200" height="120"></canvas>
                    </div>
                    <div class="canvas-item-name">${canvas.name}</div>
                    <div class="canvas-item-date">${canvas.date}</div>
                `;
                
                // Create thumbnail
                const thumbnailCanvas = canvasItem.querySelector('canvas');
                const thumbnailCtx = thumbnailCanvas.getContext('2d');
                const img = new Image();
                img.onload = function() {
                    thumbnailCtx.drawImage(img, 0, 0, 200, 120);
                };
                img.src = canvas.data;
                
                canvasItem.addEventListener('click', () => {
                    openCanvas(canvas.id);
                });
                
                canvasList.appendChild(canvasItem);
            });
        }

        // Create color options
        function createColorOptions() {
            colorOptions.innerHTML = '';
            noteColors.forEach(colorClass => {
                const colorOption = document.createElement('div');
                colorOption.className = `color-option ${colorClass}`;
                colorOption.setAttribute('data-color', colorClass);
                colorOption.addEventListener('click', () => {
                    if (selectedNoteId) {
                        changeSpecificNoteColor(selectedNoteId, colorClass);
                    }
                    // On mobile, close the color picker after selection
                    if (window.innerWidth <= 768) {
                        colorOptions.classList.remove('expanded');
                    }
                });
                colorOptions.appendChild(colorOption);
            });
        }

        // Create a new note
        function createNewNote() {
            const newNote = {
                id: Date.now().toString(),
                title: 'New Note',
                content: 'Start typing here...',
                color: noteColors[Math.floor(Math.random() * noteColors.length)],
                date: new Date().toLocaleString(),
                position: notes.length
            };
            
            notes.unshift(newNote);
            renderNotes();
            saveNotesToFirebase();
            showNotification('New note created!');
        }

        // Change layout
        function changeLayout(layout) {
            currentLayout = layout;
            notesContainer.className = `notes-container ${layout}-layout`;
        }

        // Search notes
        function searchNotes() {
            const searchTerm = searchInput.value.toLowerCase();
            if (searchTerm === '') {
                renderNotes();
                return;
            }
            
            const filteredNotes = notes.filter(note => 
                note.title.toLowerCase().includes(searchTerm) || 
                note.content.toLowerCase().includes(searchTerm)
            );
            
            renderNotes(filteredNotes);
        }

        // Render notes
        function renderNotes(notesToRender = notes) {
            notesContainer.innerHTML = '';
            
            notesToRender.forEach(note => {
                const noteElement = document.createElement('div');
                noteElement.className = `note ${note.color} new-note`;
                noteElement.setAttribute('draggable', 'true');
                noteElement.setAttribute('data-id', note.id);
                
                noteElement.innerHTML = `
                    <div class="note-header">
                        <input type="text" class="note-title" value="${note.title}" data-id="${note.id}">
                        <div class="note-actions">
                            <div class="note-action" data-action="preview" data-id="${note.id}">
                                <i class="fas fa-expand"></i>
                            </div>
                            <div class="note-action" data-action="delete" data-id="${note.id}">
                                <i class="fas fa-trash"></i>
                            </div>
                            <div class="note-action" data-action="color" data-id="${note.id}">
                                <i class="fas fa-palette"></i>
                            </div>
                        </div>
                    </div>
                    <textarea class="note-content" data-id="${note.id}">${note.content}</textarea>
                    <div class="note-footer">
                        <div class="note-date">${note.date}</div>
                        <div class="note-color ${note.color}"></div>
                    </div>
                `;
                
                notesContainer.appendChild(noteElement);
            });
            
            // Add event listeners to note elements
            addNoteEventListeners();
        }

        // Add event listeners to note elements
        function addNoteEventListeners() {
            // Preview note
            document.querySelectorAll('[data-action="preview"]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const noteId = e.currentTarget.getAttribute('data-id');
                    showNotePreview(noteId);
                });
            });
            
            // Delete note
            document.querySelectorAll('[data-action="delete"]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const noteId = e.currentTarget.getAttribute('data-id');
                    deleteNote(noteId);
                });
            });
            
            // Change note color - FIXED FOR MOBILE
            document.querySelectorAll('[data-action="color"]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation(); // Prevent event bubbling
                    selectedNoteId = e.currentTarget.getAttribute('data-id');
                    
                    // On mobile, show the color picker
                    if (window.innerWidth <= 768) {
                        colorOptions.classList.add('expanded');
                    } else {
                        // On desktop, assign a random color immediately
                        const randomColor = noteColors[Math.floor(Math.random() * noteColors.length)];
                        changeSpecificNoteColor(selectedNoteId, randomColor);
                    }
                });
            });
            
            // Update note title
            document.querySelectorAll('.note-title').forEach(input => {
                input.addEventListener('change', (e) => {
                    const noteId = e.target.getAttribute('data-id');
                    updateNote(noteId, 'title', e.target.value);
                });
            });
            
            // Update note content
            document.querySelectorAll('.note-content').forEach(textarea => {
                textarea.addEventListener('change', (e) => {
                    const noteId = e.target.getAttribute('data-id');
                    updateNote(noteId, 'content', e.target.value);
                });
            });
        }

        // Show note preview in modal
        function showNotePreview(noteId) {
            const note = notes.find(note => note.id === noteId);
            if (note) {
                modalTitle.textContent = note.title;
                modalBody.textContent = note.content;
                previewModal.classList.add('active');
            }
        }

        // Delete note
        function deleteNote(noteId) {
            notes = notes.filter(note => note.id !== noteId);
            renderNotes();
            saveNotesToFirebase();
            showNotification('Note deleted!');
        }

        // Change specific note color
        function changeSpecificNoteColor(noteId, colorClass) {
            const note = notes.find(note => note.id === noteId);
            if (note) {
                note.color = colorClass;
                note.date = new Date().toLocaleString();
                renderNotes();
                saveNotesToFirebase();
                showNotification('Note color changed!');
            }
        }

        // Update note
        function updateNote(noteId, field, value) {
            const note = notes.find(note => note.id === noteId);
            if (note) {
                note[field] = value;
                note.date = new Date().toLocaleString();
                saveNotesToFirebase();
            }
        }

        // Show random motivational quote
        function showRandomQuote() {
            const randomIndex = Math.floor(Math.random() * motivationalQuotes.length);
            const quote = motivationalQuotes[randomIndex];
            
            quoteText.textContent = `"${quote.text}"`;
            quoteAuthor.textContent = `- ${quote.author}`;
            
            // Add animation class
            quoteSection.classList.add('show', 'quote-animation');
            
            // Remove animation class after animation completes
            setTimeout(() => {
                quoteSection.classList.remove('quote-animation');
            }, 500);
            
            // Auto hide after 7 seconds
            setTimeout(() => {
                quoteSection.classList.remove('show');
            }, 7000);
            
            showNotification('Here\'s some motivation for you!');
        }

        // Drag and drop handlers
        function handleDragStart(e) {
            if (e.target.classList.contains('note')) {
                draggedNote = e.target;
                e.target.classList.add('dragging');
                
                // Set drag image
                e.dataTransfer.setDragImage(e.target, 0, 0);
                e.dataTransfer.effectAllowed = 'move';
            }
        }

        function handleDragEnd(e) {
            if (e.target.classList.contains('note')) {
                e.target.classList.remove('dragging');
                draggedNote = null;
            }
        }

        function handleDragOver(e) {
            e.preventDefault();
            const afterElement = getDragAfterElement(e.clientY);
            const draggable = document.querySelector('.dragging');
            if (draggable && afterElement && afterElement !== draggable.nextSibling) {
                notesContainer.insertBefore(draggable, afterElement);
            }
        }

        function handleDrop(e) {
            e.preventDefault();
            // Update note positions in the notes array
            const noteElements = Array.from(notesContainer.querySelectorAll('.note'));
            notes = noteElements.map((el, index) => {
                const noteId = el.getAttribute('data-id');
                const note = notes.find(n => n.id === noteId);
                note.position = index;
                return note;
            });
            
            saveNotesToFirebase();
        }

        function getDragAfterElement(y) {
            const draggableElements = [...notesContainer.querySelectorAll('.note:not(.dragging)')];
            
            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }

        // Firebase functions
        function saveNotesToFirebase() {
            database.ref('notes').set(notes)
                .then(() => {
                    console.log('Notes saved to Firebase');
                })
                .catch(error => {
                    console.error('Error saving notes: ', error);
                });
        }

        function loadNotesFromFirebase() {
            database.ref('notes').on('value', (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    notes = data;
                    renderNotes();
                } else {
                    // Create a sample note if no notes exist
                    createSampleNote();
                }
            });
        }

        function saveCanvasesToFirebase() {
            database.ref('canvases').set(canvases)
                .then(() => {
                    console.log('Canvases saved to Firebase');
                })
                .catch(error => {
                    console.error('Error saving canvases: ', error);
                });
        }

        function loadCanvasesFromFirebase() {
            database.ref('canvases').on('value', (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    canvases = data;
                }
            });
        }

        function syncNotesWithFirebase() {
            syncNotesBtn.classList.add('pulse');
            saveNotesToFirebase();
            saveCanvasesToFirebase();
            setTimeout(() => {
                syncNotesBtn.classList.remove('pulse');
                showNotification('Notes and canvases synced with cloud!');
            }, 500);
        }

        function createSampleNote() {
            if (notes.length === 0) {
                const sampleNote = {
                    id: Date.now().toString(),
                    title: 'Welcome to Neon Notes!',
                    content: 'This is a sample note. You can edit, delete, or create new notes. All your notes are saved in the cloud!\n\nTry clicking the preview icon () to see this note in full screen!\n\nClick the palette icon to change colors.\n\nClick "Canvas" to create drawings!',
                    color: 'note-color-1',
                    date: new Date().toLocaleString(),
                    position: 0
                };
                notes.push(sampleNote);
                renderNotes();
                saveNotesToFirebase();
            }
        }

        // Show notification
        function showNotification(message) {
            notificationText.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Initialize the app
        init();
    </script>
</body>
</html>